(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-767dc79d"],{"490e":function(t,e,r){"use strict";r("9f3f")},"5a14":function(t,e,r){},"690f":function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));r("fb6a"),r("d3b7"),r("b0c0"),r("a630"),r("3ca3");var n=r("fe0d");function a(t,e){if(t){if("string"===typeof t)return Object(n["a"])(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Object(n["a"])(t,e):void 0}}},"99af":function(t,e,r){"use strict";var n=r("23e7"),a=r("d039"),s=r("e8b5"),o=r("861d"),i=r("7b0b"),c=r("50c4"),u=r("8418"),l=r("65f0"),d=r("1dde"),m=r("b622"),f=r("2d00"),b=m("isConcatSpreadable"),p=9007199254740991,v="Maximum allowed index exceeded",h=f>=51||!a((function(){var t=[];return t[b]=!1,t.concat()[0]!==t})),g=d("concat"),w=function(t){if(!o(t))return!1;var e=t[b];return void 0!==e?!!e:s(t)},y=!h||!g;n({target:"Array",proto:!0,forced:y},{concat:function(t){var e,r,n,a,s,o=i(this),d=l(o,0),m=0;for(e=-1,n=arguments.length;e<n;e++)if(s=-1===e?o:arguments[e],w(s)){if(a=c(s.length),m+a>p)throw TypeError(v);for(r=0;r<a;r++,m++)r in s&&u(d,m,s[r])}else{if(m>=p)throw TypeError(v);u(d,m++,s)}return d.length=m,d}})},"9f3f":function(t,e,r){},a630:function(t,e,r){var n=r("23e7"),a=r("4df4"),s=r("1c7e"),o=!s((function(t){Array.from(t)}));n({target:"Array",stat:!0,forced:o},{from:a})},ad68:function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"container py-5"},[r("h1",[t._v("餐廳描述頁")]),r("RestaurantDetail",{attrs:{"initial-restaurant":t.restaurant}}),r("hr"),r("RestaurantComments",{attrs:{restaurantComments:t.restaurantComments},on:{"after-delete-comment":t.afterDeleteComment}}),r("CreateComments",{attrs:{restaurant:t.restaurant},on:{"after-create-comment":t.afterCreateComment}})],1)},a=[],s=r("5530"),o=r("1da1"),i=(r("96cf"),r("b0c0"),r("a4d3"),r("e01a"),r("4de4"),function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"row"},[r("div",{staticClass:"col-md-12 mb-3"},[r("h1",[t._v(t._s(t.showRestaurant.name))]),r("p",{staticClass:"badge badge-secondary mt-1 mb-3"},[t._v(" "+t._s(t.showRestaurant.categoryName)+" ")])]),r("div",{staticClass:"col-lg-4"},[r("img",{staticClass:"img-responsive center-block",staticStyle:{width:"250px","margin-bottom":"25px"},attrs:{src:t.showRestaurant.image}}),r("div",{staticClass:"contact-info-wrap"},[r("ul",{staticClass:"list-unstyled"},[r("li",[r("strong",[t._v("Opening Hour:")]),t._v(" "+t._s(t.showRestaurant.openingHours)+" ")]),r("li",[r("strong",[t._v("Tel:")]),t._v(" "+t._s(t.showRestaurant.tel)+" ")]),r("li",[r("strong",[t._v("Address:")]),t._v(" "+t._s(t.showRestaurant.address)+" ")])])])]),r("div",{staticClass:"col-lg-8"},[r("p",[t._v(t._s(t.showRestaurant.description))]),r("router-link",{staticClass:"btn btn-primary btn-border mr-2",attrs:{to:{name:"restaurant-dashboard",params:{id:t.showRestaurant.id}}}},[t._v("Dashboard")]),t.showRestaurant.isFavorited?r("button",{staticClass:"btn btn-danger btn-border mr-2",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.deleteFavorite(t.showRestaurant.id)}}},[t._v(" 移除最愛 ")]):r("button",{staticClass:"btn btn-primary btn-border mr-2",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.addToFavorite(t.showRestaurant.id)}}},[t._v(" 加到最愛 ")]),t.showRestaurant.isLiked?r("button",{staticClass:"btn btn-danger like mr-2",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.deleteLike(t.showRestaurant.id)}}},[t._v(" Unlike ")]):r("button",{staticClass:"btn btn-primary like mr-2",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.addToLike(t.showRestaurant.id)}}},[t._v(" Like ")])],1)])}),c=[],u=r("4cce"),l=r("c968"),d={props:{initialRestaurant:{type:Object,required:!0}},data:function(){return{showRestaurant:this.initialRestaurant}},watch:{initialRestaurant:function(t){this.showRestaurant=Object(s["a"])(Object(s["a"])({},this.showRestaurant),t)}},methods:{addToFavorite:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,u["a"].addFavorite({restaurantId:t});case 3:if(n=r.sent,a=n.data,console.log(a),"success"===a.status){r.next=8;break}throw new Error(a.message);case 8:e.showRestaurant=Object(s["a"])(Object(s["a"])({},e.showRestaurant),{},{isFavorited:!0}),r.next=15;break;case 11:r.prev=11,r.t0=r["catch"](0),console.error(r.t0.message),l["a"].fire({icon:"error",title:"無法將餐廳加入最愛，請稍後再試"});case 15:case"end":return r.stop()}}),r,null,[[0,11]])})))()},deleteFavorite:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,u["a"].deleteFavorite({restaurantId:t});case 3:if(n=r.sent,a=n.data,console.log(a),"success"===a.status){r.next=8;break}throw new Error(a.message);case 8:e.showRestaurant=Object(s["a"])(Object(s["a"])({},e.showRestaurant),{},{isFavorited:!1}),r.next=15;break;case 11:r.prev=11,r.t0=r["catch"](0),console.error(r.t0.message),l["a"].fire({icon:"error",title:"無法將餐廳加入最愛，請稍後再試"});case 15:case"end":return r.stop()}}),r,null,[[0,11]])})))()},addToLike:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,u["a"].addLike({restaurantId:t});case 3:if(n=r.sent,a=n.data,"success"===a.status){r.next=7;break}throw new Error(a.message);case 7:e.showRestaurant=Object(s["a"])(Object(s["a"])({},e.showRestaurant),{},{isLiked:!0}),r.next=14;break;case 10:r.prev=10,r.t0=r["catch"](0),console.error(r.t0.message),l["a"].fire({icon:"error",title:"無法將餐廳加入最愛，請稍後再試"});case 14:case"end":return r.stop()}}),r,null,[[0,10]])})))()},deleteLike:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,u["a"].deleteLike({restaurantId:t});case 3:if(n=r.sent,a=n.data,"success"===a.status){r.next=7;break}throw new Error(a.message);case 7:e.showRestaurant=Object(s["a"])(Object(s["a"])({},e.showRestaurant),{},{isLiked:!1}),r.next=14;break;case 10:r.prev=10,r.t0=r["catch"](0),console.error(r.t0.message),l["a"].fire({icon:"error",title:"無法將餐廳加入最愛，請稍後再試"});case 14:case"end":return r.stop()}}),r,null,[[0,10]])})))()}}},m=d,f=(r("cd59"),r("2877")),b=Object(f["a"])(m,i,c,!1,null,"1f7b3f32",null),p=b.exports,v=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("h2",{staticClass:"my-4"},[t._v("所有評論：")]),t._l(t.comments,(function(e){return r("div",{key:e.id},[r("blockquote",{staticClass:"blockquote mb-0"},[t.currentUser.isAdmin?r("button",{staticClass:"btn btn-danger float-right",attrs:{type:"button",disabled:t.isProcessing},on:{click:function(r){return r.preventDefault(),r.stopPropagation(),t.handleDeleteButtonClick(e.id)}}},[t._v(" Delete ")]):t._e(),r("h3",[r("router-link",{attrs:{to:"/users"}},[t._v(" "+t._s(e.name)+" ")])],1),r("p",[t._v(t._s(e.text))]),r("footer",{staticClass:"blockquote-footer"},[t._v(" "+t._s(t._f("fromNow")(e.createdAt))+" ")])]),r("hr")])}))],2)},h=[],g=r("fe0d");function w(t){if(Array.isArray(t))return Object(g["a"])(t)}r("d3b7"),r("d28b"),r("3ca3"),r("ddb0"),r("a630");function y(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}var C=r("690f");function k(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function x(t){return w(t)||y(t)||Object(C["a"])(t)||k()}r("99af");var R=r("2708"),_=r("2f62"),j={name:"restaurantComments",mixins:[R["b"]],props:{restaurantComments:{type:Array,required:!0}},data:function(){return{comments:[],isProcessing:!1}},created:function(){console.log("restaurantComments:",this.restaurantComments),console.log("comments:",this.comments)},watch:{restaurantComments:function(t){this.comments=[].concat(x(this.comments),x(t))}},methods:{handleDeleteButtonClick:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,e.isProcessing=!0,console.log("handDeleteButtonClick",t),r.next=5,u["a"].deleteComments({commentId:t});case 5:n=r.sent,console.log("delete:",n),e.$emit("after-delete-comment",t),e.isProcessing=!1,r.next=15;break;case 11:r.prev=11,r.t0=r["catch"](0),e.isProcessing=!1,l["a"].fire({icon:"error",title:"現在無法刪除餐廳，請稍後再試"});case 15:case"end":return r.stop()}}),r,null,[[0,11]])})))()}},computed:Object(s["a"])({},Object(_["b"])(["currentUser"]))},O=j,A=(r("490e"),Object(f["a"])(O,v,h,!1,null,"25f32184",null)),S=A.exports,D=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("form",{on:{submit:function(e){return e.preventDefault(),e.stopPropagation(),t.handleSubmit(e)}}},[r("div",{staticClass:"form-group mb-4"},[r("label",{attrs:{for:"text"}},[t._v("留下評論：")]),r("textarea",{directives:[{name:"model",rawName:"v-model",value:t.text,expression:"text"}],staticClass:"form-control",attrs:{rows:"3",name:"text"},domProps:{value:t.text},on:{input:function(e){e.target.composing||(t.text=e.target.value)}}})]),r("div",{staticClass:"d-flex align-items-center justify-content-between"},[r("button",{staticClass:"btn btn-link",attrs:{type:"button"},on:{click:function(e){return t.$router.back()}}},[t._v(" 回上一頁 ")]),r("button",{staticClass:"btn btn-primary mr-0",attrs:{type:"submit"}},[t._v("Submit")])])])},L=[],U={props:{restaurant:{type:Object,required:!0}},data:function(){return{text:""}},methods:{handleSubmit:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t.text||l["a"].fire({icon:"warning",title:"您尚未填寫任何回覆"}),e.next=4,u["a"].createComments({Restaurant:{id:t.restaurant.id,name:t.restaurant.name},text:t.text,User:{id:t.currentUser.id,name:t.currentUser.name}});case 4:if(r=e.sent,n=r.data,console.log(n),"success"===n.status){e.next=9;break}throw new Error(n.message);case 9:t.$emit("after-create-comment",{commentId:n.commentId,restaurant:t.restaurant,text:t.text}),t.text="",e.next=16;break;case 13:e.prev=13,e.t0=e["catch"](0),l["a"].fire({icon:"error",title:"無法新增評論，請稍候再試"});case 16:case"end":return e.stop()}}),e,null,[[0,13]])})))()}},computed:Object(s["a"])({},Object(_["b"])(["currentUser"]))},E=U,F=(r("c8eb"),Object(f["a"])(E,D,L,!1,null,"513a7960",null)),I=F.exports,P=r("c4c3"),$={components:{RestaurantDetail:p,RestaurantComments:S,CreateComments:I},data:function(){return{restaurant:{id:-1,name:"",categoryName:"",image:"",openingHours:"",tel:"",address:"",description:"",isFavorited:!1,isLiked:!1},restaurantComments:[]}},created:function(){var t=this.$route.params.id;this.fetchRestaurant(t)},beforeRouteUpdate:function(t,e,r){var n=t.params.id;this.fetchRestaurant(n),r()},methods:{fetchRestaurant:function(t){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var n,a,o,i,c;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,P["a"].getRestaurant({restaurantId:t});case 3:n=r.sent,a=n.data,console.log("data: ",a),o=a.restaurant,i=a.isFavorited,c=a.isLiked,e.restaurant=Object(s["a"])(Object(s["a"])({},e.restaurant),{},{id:o.id,name:o.name,categoryName:o.Category?o.Category.name:"未分類",image:o.image,openingHours:o.opening_hours,tel:o.tel,address:o.address,description:o.description,isFavorited:i,isLiked:c}),e.restaurantComments=o.Comments,r.next=14;break;case 11:r.prev=11,r.t0=r["catch"](0),l["a"].fire({icon:"error",title:"無法取得餐廳資料，請稍候再試"});case 14:case"end":return r.stop()}}),r,null,[[0,11]])})))()},afterDeleteComment:function(t){this.restaurantComments=this.restaurantComments.filter((function(e){return e.id!==t}))},afterCreateComment:function(t){var e=t.commentId,r=t.restaurant,n=t.text;console.log(t),this.restaurantComments.push({id:e,Restaurant:{id:r.id,name:r.name},User:{id:this.currentUser.id,name:this.currentUser.name},text:n,createdAt:new Date})}},computed:Object(s["a"])({},Object(_["b"])(["currentUser"]))},T=$,q=Object(f["a"])(T,n,a,!1,null,null,null);e["default"]=q.exports},c428:function(t,e,r){},c8eb:function(t,e,r){"use strict";r("c428")},cd59:function(t,e,r){"use strict";r("5a14")},d28b:function(t,e,r){var n=r("746f");n("iterator")},e01a:function(t,e,r){"use strict";var n=r("23e7"),a=r("83ab"),s=r("da84"),o=r("5135"),i=r("861d"),c=r("9bf2").f,u=r("e893"),l=s.Symbol;if(a&&"function"==typeof l&&(!("description"in l.prototype)||void 0!==l().description)){var d={},m=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),e=this instanceof m?new l(t):void 0===t?l():l(t);return""===t&&(d[e]=!0),e};u(m,l);var f=m.prototype=l.prototype;f.constructor=m;var b=f.toString,p="Symbol(test)"==String(l("test")),v=/^Symbol\((.*)\)[^)]+$/;c(f,"description",{configurable:!0,get:function(){var t=i(this)?this.valueOf():this,e=b.call(t);if(o(d,t))return"";var r=p?e.slice(7,-1):e.replace(v,"$1");return""===r?void 0:r}}),n({global:!0,forced:!0},{Symbol:m})}},fb6a:function(t,e,r){"use strict";var n=r("23e7"),a=r("861d"),s=r("e8b5"),o=r("23cb"),i=r("50c4"),c=r("fc6a"),u=r("8418"),l=r("b622"),d=r("1dde"),m=d("slice"),f=l("species"),b=[].slice,p=Math.max;n({target:"Array",proto:!0,forced:!m},{slice:function(t,e){var r,n,l,d=c(this),m=i(d.length),v=o(t,m),h=o(void 0===e?m:e,m);if(s(d)&&(r=d.constructor,"function"!=typeof r||r!==Array&&!s(r.prototype)?a(r)&&(r=r[f],null===r&&(r=void 0)):r=void 0,r===Array||void 0===r))return b.call(d,v,h);for(n=new(void 0===r?Array:r)(p(h-v,0)),l=0;v<h;v++,l++)v in d&&u(n,l,d[v]);return n.length=l,n}})},fe0d:function(t,e,r){"use strict";function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}r.d(e,"a",(function(){return n}))}}]);
//# sourceMappingURL=chunk-767dc79d.6a98ff2e.js.map